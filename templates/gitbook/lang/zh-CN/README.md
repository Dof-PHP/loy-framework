<!-- toc -->

## HTTP 接口文档: `<?= $version ?>`

> 本手册由 Doc Generator@DOF-PHP 于 <?= fdate(null, 'T Y/m/d H:i:s') ?> 自动生成。

## 文档公约

下列公约在本手册所有接口文档中通用。

### 路由参数

所有对接口文档的定义中，包含 `{}` 的均表示路由参数，是请求参数的一部分。

示例：获取用户详情的 REST 接口为 `GET /api/users/{id}`，其中 `{id}` 实际要表示的是一个用户 ID，因此如果我们想要获取 ID 为 1 的用户详情，则我们最终请求的 URL 路径是 `GET /api/users/1`。

### 「认证授权」的四种类型

- `0`: 无需认证无需授权。
- `1`: 只需认证无需授权。
- `2`: 只需授权无需认证。
- `3`: 同时需要认证和授权。

### 关于接口返回值

除特殊情况，本手册所有接口文档均不包含接口返回值说明，因为所有 HTTP 接口实行了 GraphQL-like 调用风格——即接口要返回什么，是由客户端指定的。只不过客户端能指定返回哪些字段结构，是由具体的接口文档中的「关联数据模型」决定的。

说明：接口可关联的数据模型列表由专门的数据模型文档维护，详见：<a href="javascript:goDofDocVersion('_model')">接口数据模型</a>。

### 接口参数基本类型

在查看接口文档的时候，所有关于请求参数类型标识（包括请求参数和响应参数）的含义，均在下面的列表中说明：

| KEY | 含义 | 示例 |
| :--- | :--- | :--- |
| `Boolean` | 布尔值 | `true`, `false` |
| `Int` | 整数 | `0`, `-1`, `1` |
| `Uint` | 正整数 | `1` |
| `String` | 字符串 | `foo` |
| `Array` | 广义数组 | `[1, 2, 'a' => 3, 'b' => 4]` |
| `ValueArray`/`ScalarArray` | 值数组/标量数组 | `[1, 2, 3, 4]` |
| `IndexArray` | 下标数组 | `[1, 2, 'a', 'b']` |
| `ListArray` | 列表数组（子项同构） | `[['a' => 1, 'b' => 2], ['a' => 3, 'b' => 4]]` |
| `AssocArray`/`ObjectArray` | 关联数组/对象数组 | `['a' => 1, 'b' => 2]` |

#### 说明

- 接口参数基本类型的 KEY 不区分大小写。
- `Array`/`IndexArray`/`ValueArray`/`ScalarArray`/`ListArray`/`ObjectArray`/`AssocArray` 本质都是数组，只是在某些场景下可能需要对数组本身进行区分，因此进一步分为这几类。

### 接口参数校验规则

接口参数校验规则指的是接口参数满足前面的基本类型之后，还需要进一步对其格式和值进行校验的规则。

| KEY | 含义 | 可接受参数名 | 示例 |
| :--- | :--- | :--- | :--- |
| `EMAIL` | 电子邮箱 | - | `cjli@dofphp.org` |
| `MOBILE` | 手机号码 | `cn` => 中国大陆手机号格式 | `13344445555` |
| `IN` | 指定的参数必须在给定的枚举列表中 | - | 规则：`status` => 'in:1,2,3'<br>含义：表示名为 `status` 的参数必须是 `1`/`2`/`3` 的某一个|
| `CIIN` | 指定的参数必须在给定的枚举列表中，不区分大小写 | - | 规则：`type` => 'ciin:a,b,C'<br>含义：表示名为 `type` 的参数必须是 `a`,`A`, `b`,`B`, `c`,`C` 的某一个|
| `HOST` | 主机域名或者IP | - | `demo.dofphp.org`, `12.34.56.78` |
| `IP` | IP 地址（v4或v6） | - | `1.1.1.1`, `fe80::ea9f:cb7e:822d:711f` |
| `IPV4` | IPv4 地址 | - | `1.1.1.1` |
| `IPV6` | IPv6 地址 | - | `fe80::ea9f:cb7e:822d:711f` |
| `MIN` | 数值最小/字符串最短 | 隐式会判断基本数据类型 | `4` |
| `MAX` | 数值最大/字符串最长 | 隐式会判断基本数据类型 | `8` |
| `LENGTH` | 字符串的长度为多少 | - | `4` |
| `NEED` | 指定的参数必须 | - | - |
| `NEEDIFNO` | 如果原数据中不存在某个参数则需要该参数 | 假如不存在的参数名 | 原数据：`['a' => 1]`<br>规则：`c` => `NeedIfNo(b)`<br>结果：则此时会检查原数据中 `c` 是否存在 |
| `NEEDIFHAS` | 如果原数据中存在某个参数则需要该参数 | 假如存在的参数名 | 原数据：`['a' => 1]`<br>规则：`c => NeedIfHas(a)`<br>结果：则此时会检查 `c` 是否存在 |
| `WRAPIN` | 该参数值引用了另外一个已定义的数据格式集合 | 隐式会判断基本数据类型是否是数组 | `User.Http.Wrapper.In.ABC` |

#### 说明

- 接口参数校验规则的 KEY 也不区分大小写。
- `WrapIn` 实现了无限嵌套格式校验，关于本手册中所有文档可以使用的 `WrapIn` 列表详见：<a href="javascript:goDofDocVersion('_wrapin')">WrapIn 校验集合</a>。

<script>
function goDofDocVersion(version) {
    let url = new URL(window.location.href)
    window.location.href = url.origin + '/' + version
}
</script>